{% extends "base.html" %}
{% block title %}Tu Carrito de Compras - Dulce Rincón{% endblock %}
{% block content %}
<div class="bg-white py-12 md:py-20">
    <div class="container mx-auto px-6">
        <h1 class="text-3xl font-bold text-center text-slate-800 mb-8" style="font-family: 'Playfair Display', serif;">Tu Carrito de Compras</h1>
        {% if cart_items %}
        <div class="flex flex-col lg:flex-row gap-8">
            <div class="w-full lg:w-2/3">
                <div class="space-y-4">
                {% for item in cart_items %}
                    <div class="flex items-center bg-stone-50 p-4 rounded-lg shadow-sm border border-stone-200">
                        <img src="{{ item.imagen_url }}" alt="{{ item.nombre }}" class="w-24 h-24 rounded-md object-cover">
                        <div class="flex-grow ml-4">
                            <h2 class="font-bold text-lg text-slate-800">{{ item.nombre }}</h2>
                            <p class="text-sm text-gray-500">Precio: S/ {{ "%.2f"|format(item.precio) }}</p>
                        </div>
                        <div class="flex items-center space-x-2 md:space-x-4">
                            <form action="{{ url_for('update_cart', product_id=item.producto_id) }}" method="POST" class="flex items-center">
                                <input type="number" name="quantity" value="{{ item.cantidad }}" min="1" class="w-16 text-center border-gray-300 rounded-md">
                                <button type="submit" class="ml-2 text-xs text-blue-500 hover:underline">Actualizar</button>
                            </form>
                            <span class="font-bold w-20 md:w-24 text-right">S/ {{ "%.2f"|format(item.precio * item.cantidad) }}</span>
                            <form action="{{ url_for('remove_from_cart', product_id=item.producto_id) }}" method="POST">
                                <button type="submit" class="text-gray-400 hover:text-red-600 transition duration-200 p-1 rounded-full"><ion-icon name="trash-outline" class="h-6 w-6"></ion-icon></button>
                            </form>
                        </div>
                    </div>
                {% endfor %}
                </div>
            </div>
            <div class="w-full lg:w-1/3">
                <div class="bg-stone-100 p-6 rounded-lg shadow-md border border-pink-200">
                    <h2 class="text-2xl font-bold text-slate-800 border-b pb-4 mb-4">Resumen del Pedido</h2>
                    <div class="flex justify-between font-bold text-xl border-t pt-4 mt-4">
                        <span>Total</span>
                        <span>S/ {{ "%.2f"|format(total_price) }}</span>
                    </div>
                    <a href="{{ url_for('checkout') }}" class="mt-6 w-full block text-center bg-pink-600 text-white font-bold py-3 rounded-lg text-lg hover:bg-pink-700 transition duration-300">Proceder al Pago</a>
                </div>
            </div>
        </div>
        {% else %}
        <div class="text-center py-20 bg-stone-50 rounded-lg border-2 border-dashed border-stone-300">
            <ion-icon name="cart-outline" class="text-6xl text-stone-400 mx-auto"></ion-icon>
            <h2 class="mt-4 text-2xl font-semibold text-slate-700">Tu carrito está vacío</h2>
            <p class="mt-2 text-gray-500">Parece que aún no has añadido ningún producto.</p>
            <a href="{{ url_for('productos') }}" class="mt-6 inline-block bg-pink-500 text-white font-bold px-8 py-3 rounded-full text-lg hover:bg-pink-600 transition duration-300">Ver Productos</a>
        </div>
        {% endif %}
    </div>
</div>
{% endblock %}